<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>umami | Virtualbeck's Blog</title>
<script defer src=https://umami.virtualbeck.com/fetch.js data-website-id=86d77f9c-ba21-4fd6-827a-59469a68d418></script><meta name=keywords content="umami,tracking,page views"><meta name=description content="Listen to this article:

  

Recently, I saw on a blog (this one) a page view counter. Having seen these on webpages for over 30 years now, I wasMaybe this will help you! I wanted to take some time to document the work I’ve finally marked off the TODO list; setting up traefik and various services therein. Perhaps this will help you, but really it’s just my attempt get the info posted here so I can reference it later if needed, and move on. What is traefik? Traefik (pronounced traffic) is a modern HTTP reverse proxy and load balancer that makes deploying microservices easy. <– ripped from github page. I’m using it to host my services (including this page you’re reading now). Some are public, some are private. Some are public behind an auth mechanism. What follows is essentially a dump of my docker-compse.yaml with some secrets/personal obfuscation, with some inline comments to describe what is going on. You can also host a service that is running on another local host with the file provider context. You just mention that, as I did above, and include a matching config file in the directory specified there. Something like this: &ldquo;&ndash;providers.file.directory=/config/&rdquo; This way, you can specify the correct IP:PORT for traefik to use, rather than rely on labels. If you try to specify with labels, you will end up with an IP address assigned by docker within the host machine where traefik is running… which is fine if you don’t want things to work. Check this example out. That’s about it. Thanks for reading, and let me know if you have any questions. struck that I had no idea how they worked. So like any other curiosity, I started searching around."><meta name=author content="Mike"><link rel=canonical href=https://blog.virtualbeck.com/posts/umami/><link crossorigin=anonymous href=/assets/css/stylesheet.3e173bba341957ace9afb52226ecdf1bc9facc9f1ccbf3571cc19c18f051d8e9.css integrity="sha256-Phc7ujQZV6zpr7UiJuzfG8n6zJ8cy/NXHMGcGPBR2Ok=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.virtualbeck.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.virtualbeck.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.virtualbeck.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.virtualbeck.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.virtualbeck.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.virtualbeck.com/posts/umami/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="umami"><meta property="og:description" content="Listen to this article:

  

Recently, I saw on a blog (this one) a page view counter. Having seen these on webpages for over 30 years now, I wasMaybe this will help you! I wanted to take some time to document the work I’ve finally marked off the TODO list; setting up traefik and various services therein. Perhaps this will help you, but really it’s just my attempt get the info posted here so I can reference it later if needed, and move on. What is traefik? Traefik (pronounced traffic) is a modern HTTP reverse proxy and load balancer that makes deploying microservices easy. <– ripped from github page. I’m using it to host my services (including this page you’re reading now). Some are public, some are private. Some are public behind an auth mechanism. What follows is essentially a dump of my docker-compse.yaml with some secrets/personal obfuscation, with some inline comments to describe what is going on. You can also host a service that is running on another local host with the file provider context. You just mention that, as I did above, and include a matching config file in the directory specified there. Something like this: &ldquo;&ndash;providers.file.directory=/config/&rdquo; This way, you can specify the correct IP:PORT for traefik to use, rather than rely on labels. If you try to specify with labels, you will end up with an IP address assigned by docker within the host machine where traefik is running… which is fine if you don’t want things to work. Check this example out. That’s about it. Thanks for reading, and let me know if you have any questions. struck that I had no idea how they worked. So like any other curiosity, I started searching around."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.virtualbeck.com/posts/umami/"><meta property="og:image" content="https://blog.virtualbeck.com/static/mike.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-08T00:00:00+00:00"><meta property="article:modified_time" content="2025-02-08T00:00:00+00:00"><meta property="og:site_name" content="virtualbeck's blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.virtualbeck.com/static/mike.webp"><meta name=twitter:title content="umami"><meta name=twitter:description content="Listen to this article:

  

Recently, I saw on a blog (this one) a page view counter. Having seen these on webpages for over 30 years now, I wasMaybe this will help you! I wanted to take some time to document the work I’ve finally marked off the TODO list; setting up traefik and various services therein. Perhaps this will help you, but really it’s just my attempt get the info posted here so I can reference it later if needed, and move on. What is traefik? Traefik (pronounced traffic) is a modern HTTP reverse proxy and load balancer that makes deploying microservices easy. <– ripped from github page. I’m using it to host my services (including this page you’re reading now). Some are public, some are private. Some are public behind an auth mechanism. What follows is essentially a dump of my docker-compse.yaml with some secrets/personal obfuscation, with some inline comments to describe what is going on. You can also host a service that is running on another local host with the file provider context. You just mention that, as I did above, and include a matching config file in the directory specified there. Something like this: &ldquo;&ndash;providers.file.directory=/config/&rdquo; This way, you can specify the correct IP:PORT for traefik to use, rather than rely on labels. If you try to specify with labels, you will end up with an IP address assigned by docker within the host machine where traefik is running… which is fine if you don’t want things to work. Check this example out. That’s about it. Thanks for reading, and let me know if you have any questions. struck that I had no idea how they worked. So like any other curiosity, I started searching around."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.virtualbeck.com/posts/"},{"@type":"ListItem","position":2,"name":"umami","item":"https://blog.virtualbeck.com/posts/umami/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"umami","name":"umami","description":"Listen to this article: Recently, I saw on a blog (this one) a page view counter. Having seen these on webpages for over 30 years now, I wasMaybe this will help you! I wanted to take some time to document the work I’ve finally marked off the TODO list; setting up traefik and various services therein. Perhaps this will help you, but really it’s just my attempt get the info posted here so I can reference it later if needed, and move on. What is traefik? Traefik (pronounced traffic) is a modern HTTP reverse proxy and load balancer that makes deploying microservices easy. \u0026lt;– ripped from github page. I’m using it to host my services (including this page you’re reading now). Some are public, some are private. Some are public behind an auth mechanism. What follows is essentially a dump of my docker-compse.yaml with some secrets/personal obfuscation, with some inline comments to describe what is going on. You can also host a service that is running on another local host with the file provider context. You just mention that, as I did above, and include a matching config file in the directory specified there. Something like this: \u0026ldquo;\u0026ndash;providers.file.directory=/config/\u0026rdquo; This way, you can specify the correct IP:PORT for traefik to use, rather than rely on labels. If you try to specify with labels, you will end up with an IP address assigned by docker within the host machine where traefik is running… which is fine if you don’t want things to work. Check this example out. That’s about it. Thanks for reading, and let me know if you have any questions. struck that I had no idea how they worked. So like any other curiosity, I started searching around.\n","keywords":["umami","tracking","page views"],"articleBody":"Listen to this article: Recently, I saw on a blog (this one) a page view counter. Having seen these on webpages for over 30 years now, I wasMaybe this will help you! I wanted to take some time to document the work I’ve finally marked off the TODO list; setting up traefik and various services therein. Perhaps this will help you, but really it’s just my attempt get the info posted here so I can reference it later if needed, and move on. What is traefik? Traefik (pronounced traffic) is a modern HTTP reverse proxy and load balancer that makes deploying microservices easy. \u003c– ripped from github page. I’m using it to host my services (including this page you’re reading now). Some are public, some are private. Some are public behind an auth mechanism. What follows is essentially a dump of my docker-compse.yaml with some secrets/personal obfuscation, with some inline comments to describe what is going on. You can also host a service that is running on another local host with the file provider context. You just mention that, as I did above, and include a matching config file in the directory specified there. Something like this: “–providers.file.directory=/config/” This way, you can specify the correct IP:PORT for traefik to use, rather than rely on labels. If you try to specify with labels, you will end up with an IP address assigned by docker within the host machine where traefik is running… which is fine if you don’t want things to work. Check this example out. That’s about it. Thanks for reading, and let me know if you have any questions. struck that I had no idea how they worked. So like any other curiosity, I started searching around.\nThe first thought I had was that this was some sort of script that went and fetched a value from a database on page load, and either did an increment then, or afterwards. Probably afterwards, so as to keep the webpage snappy.\nThat well may be the way it is done. I’m still not sure. As I’m writing this post, I have yet to implememnt a page views: into the header of the html. But, I think I’ve stood up a portion of the solution which I’d like to write about here.\nIn my search for finding this, I was sure to mention to the google gods that whatever I chose, it should play well with Hugo, the static site generator I use to generate this whole site. One of the first results was a Hugo message board where a user was asking advice on the same topic, to which they were told: “Why don’t you just let google analytics do this?”\nEvidently, Hugo (or at least the theme I’m using, papermod) has support baked in for google analytics. I clicked the link, and it brought me to the docs on how to do so via Hugo. It was just one line. I’d put my google-analytics-id in the base config file, and re-build. Okay - well what does that look like from my standpoint of setting up that part of google?\nThe portal was a signup, and honestly it gave me an uneasy feeling. Like, google would have all the analytics of my website in exchange for a measley page view implementation. So, I kept looking. That lead me to a project named umami.\nYou can click on the link above to read more about it, but I’ll give you the gist here. It is an open-source web analytics tool that treats data privacy as a first-class citizen. It is lightweight, and can be self-hosted. So, that is what I’m doing now. I’ve spun up an umami docker container, and have it running at umami.virtualbeck.com. It collects all sorts of stats, and they are automatically anonymized so as to not identify users. This makes umami GDPR compliant.\nIt can also track actions on the website, like clicks. I have not implemented that yet - but I have implemented the most basic data collection that it comes packaged with. I can basically see page-views and view duration, along with what device and general location (country scale).\nI just added a few lines to my docker compose file, and let traefik handle the rest. Read more about traefik here. I’ll list the full setup in my docker compose file below. It refernces an endpoint cloudflare, but that is a cloudflare tunnel, which points back to my home server, so as to serve the traffic without opening up any ports to access my ssytems directly. Read more about it here. It’s great, and it’s free.\nSo the next step is how to implement a page view counter from data gethered by umami. If you see a page view counter on this website, it means my future-self has succeeded. If not, perhaps you’re too fast in reading this and I haven’t had time to implement it. Or perhaps I’ve died. Probably not though. I’ll have a writeup for that implementation when it is completed. Thanks for reading!\numami: image: ghcr.io/umami-software/umami:postgresql-v2.15 container_name: umami expose: - 3000 environment: DATABASE_URL: postgresql://REDACTED:REDACTED@db:5432/umami DATABASE_TYPE: postgresql APP_SECRET: REDACTED COLLECT_API_ENDPOINT: /api/get TRACKER_SCRIPT_NAME: fetch.js depends_on: db: condition: service_healthy init: true restart: always labels: - \"traefik.enable=true\" - \"traefik.http.routers.umami.rule=Host(`umami.virtualbeck.com`)\" - \"traefik.http.routers.umami.entrypoints=cloudflare\" healthcheck: test: [\"CMD-SHELL\", \"curl -f http://localhost:3000/api/heartbeat\"] interval: 5s timeout: 5s retries: 5 db: image: postgres:15-alpine container_name: postgres_umami environment: POSTGRES_DB: umami POSTGRES_USER: REDACTED POSTGRES_PASSWORD: REDACTED volumes: - umami-db-data:/var/lib/postgresql/data restart: always healthcheck: test: [\"CMD-SHELL\", \"pg_isready -U $${POSTGRES_USER} -d $${POSTGRES_DB}\"] interval: 5s timeout: 5s retries: 5 volumes: umami-db-data: ","wordCount":"920","inLanguage":"en","image":"https://blog.virtualbeck.com/static/mike.webp","datePublished":"2025-02-08T00:00:00Z","dateModified":"2025-02-08T00:00:00Z","author":{"@type":"Person","name":"Mike"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.virtualbeck.com/posts/umami/"},"publisher":{"@type":"Organization","name":"Virtualbeck's Blog","logo":{"@type":"ImageObject","url":"https://blog.virtualbeck.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.virtualbeck.com/ accesskey=h title="Virtualbeck's Blog (Alt + H)"><img src=https://blog.virtualbeck.com/mike.webp alt aria-label=logo height=36 width=36>Virtualbeck's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.virtualbeck.com/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://blog.virtualbeck.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.virtualbeck.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.virtualbeck.com/about/ title=About><span>About</span></a></li><li><a href=https://sudoku.virtualbeck.com/ title=Sudoku><span>Sudoku</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://blog.virtualbeck.com/ai_slop/ title=ai_slop><span>ai_slop</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.virtualbeck.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.virtualbeck.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">umami</h1><div class=post-meta><span title='2025-02-08 00:00:00 +0000 UTC'>February 8, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;920 words&nbsp;·&nbsp;Mike&nbsp;|&nbsp;<a href=https://github.com/virtualbeck/website/tree/main/content/posts/umami.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>Listen to this article:
<audio class=custom-audio controls preload=none style=width:100%><source src=/audio/TITLE_PLACEHOLDER.mp3></audio><br></p><p>Recently, I saw on a blog (<a href=https://garry.net/posts>this one</a>) a page view counter. Having seen these on webpages for over 30 years now, I wasMaybe this will help you! I wanted to take some time to document the work I’ve finally marked off the TODO list; setting up traefik and various services therein. Perhaps this will help you, but really it’s just my attempt get the info posted here so I can reference it later if needed, and move on. What is traefik? Traefik (pronounced traffic) is a modern HTTP reverse proxy and load balancer that makes deploying microservices easy. &lt;– ripped from github page. I’m using it to host my services (including this page you’re reading now). Some are public, some are private. Some are public behind an auth mechanism. What follows is essentially a dump of my docker-compse.yaml with some secrets/personal obfuscation, with some inline comments to describe what is going on. You can also host a service that is running on another local host with the file provider context. You just mention that, as I did above, and include a matching config file in the directory specified there. Something like this: &ldquo;&ndash;providers.file.directory=/config/&rdquo; This way, you can specify the correct IP:PORT for traefik to use, rather than rely on labels. If you try to specify with labels, you will end up with an IP address assigned by docker within the host machine where traefik is running… which is fine if you don’t want things to work. Check this example out. That’s about it. Thanks for reading, and let me know if you have any questions. struck that I had no idea how they worked. So like any other curiosity, I started searching around.</p><p>The first thought I had was that this was some sort of script that went and fetched a value from a database on page load, and either did an increment then, or afterwards. Probably afterwards, so as to keep the webpage snappy.</p><p>That well may be the way it is done. I&rsquo;m still not sure. As I&rsquo;m writing this post, I have yet to implememnt a <code>page views:</code> into the header of the html. But, I think I&rsquo;ve stood up a portion of the solution which I&rsquo;d like to write about here.</p><p>In my search for finding this, I was sure to mention to the google gods that whatever I chose, it should play well with Hugo, the static site generator I use to generate this whole site. One of the first results was a Hugo message board where a user was asking advice on the same topic, to which they were told: &ldquo;Why don&rsquo;t you just let google analytics do this?&rdquo;</p><p>Evidently, Hugo (or at least the theme I&rsquo;m using, papermod) has support baked in for google analytics. I clicked the link, and it brought me to the docs on how to do so via Hugo. It was just one line. I&rsquo;d put my google-analytics-id in the base config file, and re-build. Okay - well what does that look like from my standpoint of setting up that part of google?</p><p>The portal was a signup, and honestly it gave me an uneasy feeling. Like, google would have all the analytics of my website in exchange for a measley page view implementation. So, I kept looking. That lead me to a project named <a href=https://umami.is>umami</a>.</p><p>You can click on the link above to read more about it, but I&rsquo;ll give you the gist here. It is an open-source web analytics tool that treats data privacy as a first-class citizen. It is lightweight, and can be self-hosted. So, that is what I&rsquo;m doing now. I&rsquo;ve spun up an umami docker container, and have it running at <a href=https://umami.virtualbeck.com>umami.virtualbeck.com</a>. It collects all sorts of stats, and they are automatically anonymized so as to not identify users. This makes umami GDPR compliant.</p><p>It can also track actions on the website, like clicks. I have not implemented that yet - but I have implemented the most basic data collection that it comes packaged with. I can basically see page-views and view duration, along with what device and general location (country scale).</p><p>I just added a few lines to my docker compose file, and let traefik handle the rest. Read more about traefik <a href=../traefik>here</a>. I&rsquo;ll list the full setup in my docker compose file below. It refernces an endpoint cloudflare, but that is a cloudflare tunnel, which points back to my home server, so as to serve the traffic without opening up any ports to access my ssytems directly. Read more about it <a href=https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/>here</a>. It&rsquo;s great, and it&rsquo;s free.</p><p>So the next step is how to implement a page view counter from data gethered by umami. If you see a page view counter on this website, it means my future-self has succeeded. If not, perhaps you&rsquo;re too fast in reading this and I haven&rsquo;t had time to implement it. Or perhaps I&rsquo;ve died. Probably not though. I&rsquo;ll have a writeup for that implementation when it is completed. Thanks for reading!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl>  <span class=n>umami</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>image</span><span class=p>:</span> <span class=n>ghcr</span><span class=o>.</span><span class=n>io</span><span class=o>/</span><span class=n>umami</span><span class=o>-</span><span class=n>software</span><span class=o>/</span><span class=n>umami</span><span class=p>:</span><span class=n>postgresql</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mi>15</span>
</span></span><span class=line><span class=cl>    <span class=n>container_name</span><span class=p>:</span> <span class=n>umami</span>
</span></span><span class=line><span class=cl>    <span class=n>expose</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=mi>3000</span>
</span></span><span class=line><span class=cl>    <span class=n>environment</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>DATABASE_URL</span><span class=p>:</span> <span class=n>postgresql</span><span class=p>:</span><span class=o>//</span><span class=n>REDACTED</span><span class=p>:</span><span class=n>REDACTED</span><span class=err>@</span><span class=n>db</span><span class=p>:</span><span class=mi>5432</span><span class=o>/</span><span class=n>umami</span>
</span></span><span class=line><span class=cl>      <span class=n>DATABASE_TYPE</span><span class=p>:</span> <span class=n>postgresql</span>
</span></span><span class=line><span class=cl>      <span class=n>APP_SECRET</span><span class=p>:</span> <span class=n>REDACTED</span>
</span></span><span class=line><span class=cl>      <span class=n>COLLECT_API_ENDPOINT</span><span class=p>:</span> <span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>get</span>
</span></span><span class=line><span class=cl>      <span class=n>TRACKER_SCRIPT_NAME</span><span class=p>:</span> <span class=n>fetch</span><span class=o>.</span><span class=n>js</span>
</span></span><span class=line><span class=cl>    <span class=n>depends_on</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>db</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>condition</span><span class=p>:</span> <span class=n>service_healthy</span>
</span></span><span class=line><span class=cl>    <span class=n>init</span><span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl>    <span class=n>restart</span><span class=p>:</span> <span class=n>always</span>
</span></span><span class=line><span class=cl>    <span class=n>labels</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=s2>&#34;traefik.enable=true&#34;</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=s2>&#34;traefik.http.routers.umami.rule=Host(`umami.virtualbeck.com`)&#34;</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=s2>&#34;traefik.http.routers.umami.entrypoints=cloudflare&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>healthcheck</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>test</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;CMD-SHELL&#34;</span><span class=p>,</span> <span class=s2>&#34;curl -f http://localhost:3000/api/heartbeat&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=n>interval</span><span class=p>:</span> <span class=mi>5</span><span class=n>s</span>
</span></span><span class=line><span class=cl>      <span class=n>timeout</span><span class=p>:</span> <span class=mi>5</span><span class=n>s</span>
</span></span><span class=line><span class=cl>      <span class=n>retries</span><span class=p>:</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>db</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>image</span><span class=p>:</span> <span class=n>postgres</span><span class=p>:</span><span class=mi>15</span><span class=o>-</span><span class=n>alpine</span>
</span></span><span class=line><span class=cl>    <span class=n>container_name</span><span class=p>:</span> <span class=n>postgres_umami</span>
</span></span><span class=line><span class=cl>    <span class=n>environment</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>POSTGRES_DB</span><span class=p>:</span> <span class=n>umami</span>
</span></span><span class=line><span class=cl>      <span class=n>POSTGRES_USER</span><span class=p>:</span> <span class=n>REDACTED</span>
</span></span><span class=line><span class=cl>      <span class=n>POSTGRES_PASSWORD</span><span class=p>:</span> <span class=n>REDACTED</span>
</span></span><span class=line><span class=cl>    <span class=n>volumes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>umami</span><span class=o>-</span><span class=n>db</span><span class=o>-</span><span class=n>data</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>postgresql</span><span class=o>/</span><span class=n>data</span>
</span></span><span class=line><span class=cl>    <span class=n>restart</span><span class=p>:</span> <span class=n>always</span>
</span></span><span class=line><span class=cl>    <span class=n>healthcheck</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>test</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;CMD-SHELL&#34;</span><span class=p>,</span> <span class=s2>&#34;pg_isready -U $${POSTGRES_USER} -d $${POSTGRES_DB}&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=n>interval</span><span class=p>:</span> <span class=mi>5</span><span class=n>s</span>
</span></span><span class=line><span class=cl>      <span class=n>timeout</span><span class=p>:</span> <span class=mi>5</span><span class=n>s</span>
</span></span><span class=line><span class=cl>      <span class=n>retries</span><span class=p>:</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>volumes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>umami</span><span class=o>-</span><span class=n>db</span><span class=o>-</span><span class=n>data</span><span class=p>:</span>
</span></span></code></pre></div></div><footer class=post-footer><button id=like-button aria-label="Like this post">
❤️ <span id=like-count>0</span></button><style>#like-button{background:0 0;border:none;cursor:pointer;font-size:1.5em;padding:0}</style><ul class=post-tags><li><a href=https://blog.virtualbeck.com/tags/umami/>Umami</a></li><li><a href=https://blog.virtualbeck.com/tags/tracking/>Tracking</a></li><li><a href=https://blog.virtualbeck.com/tags/page-views/>Page Views</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.virtualbeck.com/>Virtualbeck's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var topButton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(topButton.style.visibility="visible",topButton.style.opacity="1"):(topButton.style.visibility="hidden",topButton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>